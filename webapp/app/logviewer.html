<!DOCTYPE html>
<html ng-app="treeherder">
    <head>
        <title>Treeherder Log Viewer </title>
        <link href="css/treeherder.css" rel="stylesheet" type="text/css">
        <link href="css/bootstrap.css" rel="stylesheet" media="screen">
    </head>
    <body ng-controller="LogviewerCtrl" ng-init="init()">
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span6">
                        <dl class="dl-horizontal">
                            <span ng-repeat="(label, value) in artifact.header">
                                <dt class="label label-info">{{label}}</dt>
                                <dd class="">{{value}}</dd>
                            </span>
                        </dl>
                    <div class="row-fluid" >
                        <div ng-repeat="step in artifact.step_data.steps"
                             ng-class="{'btn-warning': (step.error_count > 0), 'btn-success': (step.error_count == 0)}"
                             ng-click="displayLog(step)"
                             class="btn btn-block clearfix">
                            <span class="pull-left clearfix">{{step.order+1}}. {{step.name}}</span>
                            <span ng-init="time=formatTime(step.duration)"
                                 ng-mouseover="time=displayTime(step.started, step.finished)"
                                 ng-mouseleave="time=formatTime(step.duration)"
                                class="pull-right clearfix">{{time}}</span>
                            <div ng-switch on="(step.error_count > 0)">
                                <p ng-switch-when="true" class="">
                                    <div ng-repeat="error in step.errors"
                                         ng-mouseover="check=(step==displayedStep)"
                                         ng-mouseleave="check=false"
                                         ng-class="{'lv-line-highlight': check}"
                                         ng-click="scrollTo(step, error.linenumber);
                                                   $event.stopPropagation()"
                                         class="text-left pull-left lv-error-line">
                                        <span class="label lv-line-no">{{error.linenumber}}</span>
                                        <span>{{error.line}}</span>
                                    </div>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="span6 lv-log-container container well"
                     id="lv-log-container">
                    <div ng-repeat="lv_line in displayedStep.logPieces"
                         ng-class="{'label label-important': (lv_line.hasError == true)}"
                         class="lv-log-line"
                         id="lv-line-{{ lv_line.errLine }}">
                         {{ lv_line.text }}
                    </div>
                </div>
            </div>
        </div>
    <script src="vendor/angular/angular.js"></script>
    <script src="vendor/angular/angular-resource.js"></script>
    <script src="vendor/ui-bootstrap-tpls-0.4.0.js"></script>
    <script src="vendor/angular/angular-sanitize.min.js"></script>
    <script src="js/config/local.conf.js"></script>
    <script src="js/app.js"></script>
    <script src="js/services.js"></script>
    <script src="js/providers.js"></script>
    <script src="js/controllers/main.js"></script>
    <script src="js/controllers/jobs.js"></script>
    <script src="js/controllers/machines.js"></script>
    <script src="js/controllers/timeline.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/controllers/logviewer.js"></script>
    </body>
</html>
